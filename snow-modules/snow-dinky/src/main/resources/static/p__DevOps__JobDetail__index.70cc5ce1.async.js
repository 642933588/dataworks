"use strict";(self.webpackChunkdinky_web=self.webpackChunkdinky_web||[]).push([[757],{68166:function(le,K,o){var D=o(96012),P=o(85893),F=function(E){var B=E.children,L=(0,D.q_)({opacity:1,from:{opacity:0},config:{duration:100}});return(0,P.jsx)(D.q.h1,{style:L,children:B})};K.Z=F},56980:function(le,K,o){o.d(K,{G:function(){return B}});var D=o(58461),P=o(41913),F=o(14726),Z=o(67294),E=o(85893),B=function(w){var ae=w.onClick,I=w.disabled,q=I===void 0?!1:I;return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(F.ZP,{className:"options-button",title:(0,P.l)("button.showLog"),disabled:q,icon:(0,E.jsx)(D.lW,{}),onClick:function(){return ae()}})})}},47513:function(le,K,o){var D=o(60860),P=o(41913),F=o(86548),Z=o(88916),E=o(18429),B=o(66309),L=o(85893),w=function(I){var q=I.status,O=I.animation,ie=O===void 0?!0:O,C=I.bordered,ee=C===void 0?!0:C,ce=function(){switch(q){case D.Z4.DEVELOP:return{icon:(0,L.jsx)(F.Z,{}),color:"default",text:(0,P.l)("global.table.lifecycle.dev")};case D.Z4.PUBLISH:return{icon:(0,L.jsx)(Z.Z,{}),color:"green",text:(0,P.l)("global.table.lifecycle.publish")};default:return{icon:(0,L.jsx)(E.Z,{}),color:"default",text:q}}},W=ce();return(0,L.jsx)(B.Z,{icon:ie?W.icon:void 0,color:W.color,bordered:ee,children:W.text})};K.Z=w},84599:function(le,K,o){o.r(K),o.d(K,{default:function(){return hn}});var D=o(9783),P=o.n(D),F=o(5574),Z=o.n(F),E=o(47513),B=o(57932),L=o(89389),w=o(68166),ae=o(15009),I=o.n(ae),q=o(99289),O=o.n(q),ie=o(97857),C=o.n(ie),ee=o(63167),ce=o(56980),W=o(67939),ne=o(21953),$=o(58023),Ue={loading:!1,alertHistory:[]},n=o(41913),ge=o(16894),ue=o(85576),T=o(66309),A=o(67294),Ke=o(6311),Ge=o(55186),e=o(85893),ze=function(j){var a=j.jobDetail,i=(0,A.useState)(Ue),c=Z()(i,2),s=c[0],d=c[1],t=function(){d(function(l){return C()(C()({},l),{},{loading:!0})}),(0,ne.Ri)($.Z.ALERT_HISTORY_LIST,{jobInstanceId:a.instance.id}).then(function(l){d(function(h){return C()(C()({},h),{},{alertHistory:l})})}),d(function(l){return C()(C()({},l),{},{loading:!1})})};(0,A.useEffect)(function(){t()},[]);var v=function(){var f=O()(I()().mark(function l(h){return I()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return d(function(m){return C()(C()({},m),{},{loading:!0})}),r.next=3,(0,ne.m0)($.Z.ALERT_HISTORY_DELETE,h.id);case 3:t(),d(function(m){return C()(C()({},m),{},{loading:!1})});case 5:case"end":return r.stop()}},l)}));return function(h){return f.apply(this,arguments)}}(),u=function(l){ue.Z.info({title:(0,n.l)("devops.jobinfo.config.JobAlert.history.content"),bodyStyle:{width:"100%",overflow:"auto"},width:"30vw",content:(0,e.jsx)(Ke.U,{remarkPlugins:[Ge.Z],children:l.content},l.id)})},b=function(l){ue.Z.info({title:(0,n.l)("devops.jobinfo.config.JobAlert.history.log"),bodyStyle:{width:"100%",overflow:"auto"},width:"30vw",content:(0,e.jsx)(W.Z,{code:l.log,language:"java"})})},p=[{title:"ID",dataIndex:"id"},{title:(0,n.l)("devops.jobinfo.config.JobAlert.history.group"),render:function(l,h){return(0,e.jsx)(T.Z,{color:"processing",children:h.alertGroup.name})}},{title:(0,n.l)("devops.jobinfo.config.JobAlert.history.title"),dataIndex:"title"},{title:(0,n.l)("devops.jobinfo.config.JobAlert.history.content"),render:function(l,h){return(0,e.jsx)(ce.G,{onClick:function(){return u(h)}})}},{title:(0,n.l)("devops.jobinfo.config.JobAlert.history.status"),dataIndex:"status",render:function(l,h){return(0,e.jsxs)(T.Z,{color:h.status===1?"success":"error",children:[h.status===1?"Success":"Failed"," "]})}},{title:(0,n.l)("devops.jobinfo.config.JobAlert.history.log"),render:function(l,h){return(0,e.jsx)(ce.G,{onClick:function(){return b(h)}})}},{title:(0,n.l)("devops.jobinfo.config.JobAlert.history.time"),dataIndex:"createTime",valueType:"dateTime"},{title:(0,n.l)("global.table.operate"),width:"2vw",fixed:"right",render:function(l,h){return[(0,e.jsx)(ee.i,{onClick:function(){return v(h)},description:(0,n.l)("devops.jobinfo.config.JobAlert.history.delete")},"".concat(h.id,"_").concat(l,"_delete"))]}}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ge.ZP,{rowKey:"id",style:{height:"calc(100vh - 240px)"},dataSource:s.alertHistory,loading:s.loading,pagination:{hideOnSinglePage:!0,pageSize:15},size:"small",virtual:!0,search:!1,options:!1,columns:p})})},He=ze,ve=o(4393),Ve=function(S){var j=S.jobDetail;return(0,e.jsx)(w.Z,{children:(0,e.jsx)(ve.Z,{children:(0,e.jsx)(He,{jobDetail:j})})})},re=o(15055),oe=o(4755),Ee=o(87712),Ie=function(j,a){ue.Z.confirm({title:(0,n.l)("devops.jobinfo.ck.recovery"),content:(0,n.l)("devops.jobinfo.ck.recoveryConfirm","",{path:a}),okText:(0,n.l)("button.confirm"),cancelText:(0,n.l)("button.cancel"),onOk:function(){var i=O()(I()().mark(function s(){var d;return I()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,(0,oe.RL)(j,a,(0,n.l)("devops.jobinfo.ck.recovery"));case 2:d=v.sent,d&&d.code==0?(0,Ee.kk)((0,n.l)("devops.jobinfo.ck.recovery.success")):(0,Ee.Bc)((0,n.l)("devops.jobinfo.ck.recovery.failed"));case 4:case"end":return v.stop()}},s)}));function c(){return i.apply(this,arguments)}return c}()})},U=o(7646),Ze=o(8751),Ce=o(98165),Oe=o(18429),We=o(3089),G=o(14726),Ye=function(j){var a,i=j.jobDetail,c=(0,A.useRef)(),s=i==null||(a=i.jobDataDto)===null||a===void 0?void 0:a.checkpoints,d=[{title:(0,n.l)("devops.jobinfo.ck.id"),align:"center",dataIndex:"id"},{title:(0,n.l)("devops.jobinfo.ck.status"),align:"center",copyable:!0,render:function(v,u){return u.status==="COMPLETED"?(0,e.jsx)(T.Z,{icon:(0,e.jsx)(Ze.Z,{}),color:"success",children:u.status}):u.status==="IN_PROGRESS"?(0,e.jsx)(T.Z,{icon:(0,e.jsx)(Ce.Z,{spin:!0}),color:"processing",children:u.status}):u.status==="FAILED"?(0,e.jsx)(T.Z,{icon:(0,e.jsx)(Oe.Z,{}),color:"error",children:u.status}):(0,e.jsx)(T.Z,{icon:(0,e.jsx)(We.Z,{}),color:"default",children:u.status})}},{title:(0,n.l)("devops.jobinfo.ck.duration"),align:"center",copyable:!0,render:function(v,u){return(0,U.FV)(u.end_to_end_duration)}},{title:(0,n.l)("devops.jobinfo.ck.checkpoint_type"),align:"center",dataIndex:"checkpoint_type"},{title:(0,n.l)("devops.jobinfo.ck.external_path"),align:"center",copyable:!0,dataIndex:"external_path",render:function(v,u){return(0,e.jsx)(re.Z,{maxCount:60,children:u.external_path})}},{title:(0,n.l)("devops.jobinfo.ck.latest_ack_timestamp"),align:"center",dataIndex:"latest_ack_timestamp",valueType:"dateTime"},{title:(0,n.l)("devops.jobinfo.ck.state_size"),align:"center",render:function(v,u){return(0,U.Dd)(u.state_size)}},{title:(0,n.l)("devops.jobinfo.ck.trigger_timestamp"),align:"center",valueType:"dateTime",dataIndex:"trigger_timestamp"},{title:(0,n.l)("global.table.operate"),align:"center",render:function(v,u){return(0,e.jsx)(e.Fragment,{children:u.status==="COMPLETED"?(0,e.jsx)(G.ZP,{onClick:function(){var p;return Ie(i==null||(p=i.instance)===null||p===void 0?void 0:p.taskId,u.external_path)},children:(0,n.l)("devops.jobinfo.ck.recovery.recoveryTo")}):void 0})}}];return(0,e.jsx)(ge.ZP,{columns:d,style:{width:"100%",height:"calc(100vh - 450px)"},dataSource:s==null?void 0:s.history,onDataSourceChange:function(){var v;return(v=c.current)===null||v===void 0?void 0:v.reload()},actionRef:c,rowKey:"id",pagination:{defaultPageSize:10,showSizeChanger:!0},toolBarRender:!1,dateFormatter:"string",search:!1,size:"small"})},we=Ye,me=o(94465),Qe=o(11475),y=o(11198),pe=o(42075),Xe=function(j){var a,i,c,s,d,t,v,u,b,p,f,l,h,g,r,m,x,k,R,z,X,_=j.jobDetail,J=_==null||(a=_.jobDataDto)===null||a===void 0||(a=a.checkpoints)===null||a===void 0?void 0:a.counts,H=_==null||(i=_.jobDataDto)===null||i===void 0||(i=i.checkpoints)===null||i===void 0?void 0:i.latest,M=_==null||(c=_.jobDataDto)===null||c===void 0?void 0:c.checkpointsConfig;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(y.Z,{bordered:!0,size:"small",column:4,children:[(0,e.jsx)(y.Z.Item,{label:"Checkpoint Mode",children:(0,e.jsx)(T.Z,{color:"blue",title:"Checkpoint Mode",children:(s=M==null||(d=M.mode)===null||d===void 0?void 0:d.toUpperCase())!==null&&s!==void 0?s:"None"})}),(0,e.jsx)(y.Z.Item,{label:"Interval",children:(0,e.jsx)(T.Z,{color:"blue",title:"Interval",children:(t=M==null?void 0:M.interval)!==null&&t!==void 0?t:"None"})}),(0,e.jsx)(y.Z.Item,{label:"Timeout",children:(0,e.jsx)(T.Z,{color:"blue",title:"Timeout",children:(v=M==null?void 0:M.timeout)!==null&&v!==void 0?v:"None"})}),(0,e.jsx)(y.Z.Item,{label:"Unaligned Checkpoints ",children:(0,e.jsx)(T.Z,{color:"blue",title:"Unaligned Checkpoints",children:M!=null&&M.unaligned_checkpoints?"Enabled":"Disabled"})}),(0,e.jsx)(y.Z.Item,{label:"Latest Restored",children:(0,e.jsx)(T.Z,{color:"green",title:"Latest Completed CheckPoint",children:(0,e.jsx)(re.Z,{maxCount:30,children:(u=H==null||(b=H.restored)===null||b===void 0?void 0:b.external_path)!==null&&u!==void 0?u:"None"})})}),(0,e.jsx)(y.Z.Item,{label:"Latest Failed CheckPoint",children:(0,e.jsxs)(T.Z,{color:"red",title:"Latest Failed CheckPoint",children:["id: ",(p=H==null||(f=H.failed)===null||f===void 0?void 0:f.id)!==null&&p!==void 0?p:"None"]})}),(0,e.jsx)(y.Z.Item,{label:"Latest Completed CheckPoint",children:(0,e.jsx)(T.Z,{color:"green",title:"Latest Completed CheckPoint",children:(0,e.jsx)(re.Z,{maxCount:30,children:(l=H==null||(h=H.completed)===null||h===void 0?void 0:h.external_path)!==null&&l!==void 0?l:"None"})})}),(0,e.jsx)(y.Z.Item,{label:"Persist Checkpoints Externally Enabled",children:(0,e.jsx)(T.Z,{color:"blue",title:"Persist Checkpoints Externally Enabled",children:M!=null&&(g=M.externalization)!==null&&g!==void 0&&g.enabled?"Enabled":"Disabled"})}),(0,e.jsx)(y.Z.Item,{label:"Latest Savepoint",children:(0,e.jsx)(T.Z,{color:"purple",title:"Latest Savepoint",children:(0,e.jsx)(re.Z,{maxCount:30,children:(r=H==null||(m=H.savepoint)===null||m===void 0?void 0:m.external_path)!==null&&r!==void 0?r:"None"})})}),(0,e.jsx)(y.Z.Item,{label:"CheckPoint Counts",children:(0,e.jsxs)(pe.Z,{direction:"horizontal",children:[(0,e.jsxs)(T.Z,{color:"blue",title:"Total",children:[(0,e.jsx)(me.Z,{})," Total: ",(x=J==null?void 0:J.total)!==null&&x!==void 0?x:0]}),(0,e.jsxs)(T.Z,{color:"red",title:"Failed",children:[(0,e.jsx)(Oe.Z,{})," Failed: ",(k=J==null?void 0:J.failed)!==null&&k!==void 0?k:0]}),(0,e.jsxs)(T.Z,{color:"cyan",title:"Restored",children:[(0,e.jsx)(Qe.Z,{})," Restored: ",(R=J==null?void 0:J.restored)!==null&&R!==void 0?R:0]}),(0,e.jsxs)(T.Z,{color:"green",title:"Completed",children:[(0,e.jsx)(Ze.Z,{})," Completed: ",(z=J==null?void 0:J.completed)!==null&&z!==void 0?z:0]}),(0,e.jsxs)(T.Z,{color:"orange",title:"In Progress",children:[(0,e.jsx)(Ce.Z,{spin:!0})," In Progress: ",(X=J==null?void 0:J.in_progress)!==null&&X!==void 0?X:0]})]})})]})})},_e=Xe,qe=o(25538),et=function(j){var a,i=j.jobDetail,c=(0,A.useRef)(),s=[{title:(0,n.l)("devops.jobinfo.ck.id"),align:"center",dataIndex:"id",hideInTable:!0},{title:(0,n.l)("devops.jobinfo.ck.taskid"),align:"center",dataIndex:"taskId",hideInTable:!0},{title:(0,n.l)("devops.jobinfo.ck.name"),align:"center",dataIndex:"name"},{title:(0,n.l)("devops.jobinfo.ck.checkpoint_type"),align:"center",dataIndex:"type"},{title:(0,n.l)("devops.jobinfo.ck.external_path"),align:"center",copyable:!0,dataIndex:"path",render:function(t,v){return(0,e.jsx)(re.Z,{maxCount:60,children:v.path})}},{title:(0,n.l)("devops.jobinfo.ck.trigger_timestamp"),align:"center",valueType:"dateTime",dataIndex:"createTime"},{title:(0,n.l)("global.table.operate"),align:"center",render:function(t,v){return(0,e.jsx)(G.ZP,{onClick:function(){var b;return Ie(i==null||(b=i.instance)===null||b===void 0?void 0:b.taskId,v.path)},children:(0,n.l)("devops.jobinfo.ck.recovery.recoveryTo")})}}];return(0,e.jsx)(ge.ZP,{columns:s,style:{width:"100%",height:"calc(100vh - 450px)"},request:function(t,v,u){return(0,qe.M2)($.Z.GET_SAVEPOINT_LIST,C()(C()({},t),{},{sorter:v,filter:u}))},params:{taskId:i==null||(a=i.instance)===null||a===void 0?void 0:a.taskId},actionRef:c,toolBarRender:!1,rowKey:"id",pagination:{pageSize:10},search:!1,size:"small"})},tt=et,V=o(38345),xe=o(92398),Pe=xe.Z.TabPane,nt=function(j){var a=j.jobDetail;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(V.Z,{children:(0,e.jsx)(_e,{jobDetail:a})}),(0,e.jsx)("br",{}),(0,e.jsx)(V.Z,{children:(0,e.jsxs)(xe.Z,{defaultActiveKey:"history",size:"small",children:[(0,e.jsx)(Pe,{tab:"History",children:(0,e.jsx)(we,{jobDetail:a})},"history"),(0,e.jsx)(Pe,{tab:"SavePoint",children:(0,e.jsx)(tt,{jobDetail:a})},"savepoint")]})})]})},ot=nt,at=o(9408),Le=o(59720),jn=o(11904),it=function(j){var a=j.jobDetail.id,i=A.useState({tables:[],relations:[]}),c=Z()(i,2),s=c[0],d=c[1],t=function(){(0,ne.Ri)($.Z.JOB_INSTANCE_GET_LINEAGE,{id:a}).then(function(u){return d(u)})};return(0,A.useEffect)(function(){t()},[a]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ve.Z,{hoverable:!0,bodyStyle:{height:"100%"},style:{height:parent.innerHeight-180},children:s&&(s.tables.length!==0||s.relations.length!==0)?(0,e.jsx)(at.Z,{lineageData:s,refreshCallBack:t}):(0,e.jsx)(Le.ZP,{style:{height:"100%"},status:"warning",title:(0,n.l)("lineage.getError")})})})},rt=it,lt=o(19632),Ae=o.n(lt),te=o(17057),De=o(71230),he=o(15746),je=o(2487),st=o(27484),dt=o.n(st),Te=te.Z.Paragraph,bn=te.Z.Text,ct=function(j){var a=j.jobDetail,i=(0,A.useState)({exceptionName:"",location:"",stacktrace:"",taskName:"",timestamp:""}),c=Z()(i,2),s=c[0],d=c[1],t=function(){var u,b,p=[],f=a==null||(u=a.jobDataDto)===null||u===void 0?void 0:u.exceptions["root-exception"];return p.push({taskName:"RootException",stacktrace:f,exceptionName:f}),p.push.apply(p,Ae()((b=a.jobDataDto)===null||b===void 0?void 0:b.exceptions.exceptionHistory.entries)),(0,e.jsxs)(De.Z,{children:[(0,e.jsx)(he.Z,{span:3,children:(0,e.jsx)("div",{id:"scrollableDiv",children:(0,e.jsx)(je.Z,{size:"small",header:"Exception List",dataSource:p,renderItem:function(h){return(0,e.jsx)(je.Z.Item,{onClick:function(){return d(h)},children:(0,e.jsx)(Te,{ellipsis:!0,children:h.taskName})})}})})}),(0,e.jsx)(he.Z,{span:21,children:(0,e.jsxs)(ve.Z,{title:s.taskName,bordered:!1,extra:(0,e.jsx)(Te,{children:dt()(s.timestamp).format("YYYY-MM-DD HH:mm:ss.SSS")}),children:[(0,e.jsx)(Te,{ellipsis:{rows:1,expandable:!1},children:(0,e.jsx)("blockquote",{children:s.exceptionName})}),(0,e.jsx)(W.Z,{code:s.stacktrace?s.stacktrace:"No Exception",height:"calc(100vh - 350px)",showFloatButton:!0})]})})]})};return(0,e.jsx)(V.Z,{bodyStyle:{height:"100%",overflow:"auto"},children:t()})},ut=ct,Q=o(57344),se=o(57953),vt=function(j){var a,i=j.jobDetail,c=i==null||(a=i.history)===null||a===void 0?void 0:a.jobManagerAddress,s=(0,A.useState)("LOG"),d=Z()(s,2),t=d[0],v=d[1],u=(0,Q.useRequest)({url:$.Z.GET_JOBMANAGER_LOG,params:{address:c}}),b=(0,Q.useRequest)({url:$.Z.GET_JOBMANAGER_STDOUT,params:{address:c}}),p=(0,Q.useRequest)({url:$.Z.GET_JOBMANAGER_THREAD_DUMP,params:{address:c}}),f=function(r,m){return(0,e.jsx)(se.Z,{spinning:r.loading,children:(0,e.jsx)(W.Z,{showFloatButton:!0,language:m,code:r.data?r.data:"No Log",height:parent.innerHeight-300})})},l=function(r){if(r.data){var m=JSON.parse(r.data)&&JSON.parse(r.data).threadInfos;if(m){if(m&&m.length===0)return"No Thread Info"}else return"No Log";return m.map(function(x){return x.stringifiedThreadInfo}).join("")}else return},h=function(r,m){var x;return(0,e.jsx)(se.Z,{spinning:r.loading,children:(0,e.jsx)(W.Z,{showFloatButton:!0,language:m,code:(x=l(r))!==null&&x!==void 0?x:"No Log",height:"calc(100vh - 250px)"})})};return(0,e.jsx)(V.Z,{headerBordered:!0,bordered:!0,bodyStyle:{height:parent.innerHeight,overflow:"auto"},tabs:{size:"small",tabPosition:"top",activeKey:t,onChange:v,items:[{label:"Log",key:"LOG",children:f(u,"javalog")},{label:"Std Out",key:"STDOUT",children:f(b,"javalog")},{label:"Thread Dump",key:"DUMP",children:h(p,"java")}]}})},ht=vt,ke=te.Z.Paragraph,fn=te.Z.Text,jt=function(j){var a,i=j.jobDetail,c=(0,A.useState)({containerId:"1",containerPath:"",dataPort:"",freeSlots:"",slotsNumber:"",timeSinceLastHeartbeat:""}),s=Z()(c,2),d=s[0],t=s[1],v=i==null||(a=i.history)===null||a===void 0?void 0:a.jobManagerAddress,u=(0,Q.useRequest)({url:$.Z.GET_TASKMANAGER_LIST,params:{address:v}}),b=(0,Q.useRequest)(function(l){return{url:$.Z.GET_TASKMANAGER_LOG,params:{address:v,containerId:l}}},{manual:!0}),p=function(h){t(h),b.run(h.containerId)},f=function(){return(0,e.jsxs)(De.Z,{children:[(0,e.jsx)(he.Z,{span:3,children:(0,e.jsx)("div",{id:"scrollableDiv",children:(0,e.jsx)(je.Z,{size:"small",header:"TaskManager List",dataSource:u.data,renderItem:function(g){return(0,e.jsx)(je.Z.Item,{onClick:function(){return p(g)},children:(0,e.jsx)(ke,{ellipsis:!0,children:g.containerId})})}})})}),(0,e.jsx)(he.Z,{span:21,children:(0,e.jsx)(ve.Z,{title:d.containerId,bordered:!1,extra:(0,e.jsx)(ke,{children:d.containerPath}),children:(0,e.jsx)(se.Z,{spinning:b.loading,children:(0,e.jsx)(W.Z,{showFloatButton:!0,code:b.data,language:"javalog",height:"calc(100vh - 340px)"})})})})]})};return(0,e.jsx)(V.Z,{bodyStyle:{height:parent.innerHeight-200,overflow:"auto"},children:f()})},bt=jt,ft=function(j){var a=j.jobDetail,i=(0,A.useState)("Exception"),c=Z()(i,2),s=c[0],d=c[1],t=[{label:"Exception",key:"Exception",children:(0,e.jsx)(ut,{jobDetail:a})},{label:"JobManager",key:"JobManager",children:(0,e.jsx)(ht,{jobDetail:a})},{label:"TaskManager",key:"TaskManager",children:(0,e.jsx)(bt,{jobDetail:a})}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(V.Z,{tabs:{size:"small",tabPosition:"left",type:"card",activeKey:s,onChange:d,items:t}})})},gt=ft,mt=o(94524),Re=o(60860);function pt(S){if(!S)return{};var j={};return S.forEach(function(a){a.vertices in j||(j[a.vertices]=[]),j[a.vertices].push(a)}),j}var de=o(49603),xt=o(40784),Dt=function(j){var a,i,c=j.vertice,s=j.onValueChange,d=j.initSelected,t=j.jobDetail,v=(0,A.useState)(d==null?void 0:d.map(function(m){return m.metrics})),u=Z()(v,2),b=u[0],p=u[1],f=(a=t.clusterInstance)===null||a===void 0?void 0:a.jobManagerHost,l=(i=t.jobDataDto.job)===null||i===void 0?void 0:i.jid,h=(0,L.Z)(de.Ru,{defaultParams:[f,l,c.id]}),g=h.data,r=function(x){p(x),s(c,x)};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(xt.Z,{showSearch:!0,dataSource:g!=null?g:[],titles:[(0,n.l)("devops.jobinfo.metrics.metricsItems"),(0,n.l)("devops.jobinfo.metrics.selected")],targetKeys:b,onChange:r,rowKey:function(x){return x.id},render:function(x){return x.id},listStyle:{width:"42vh",height:"50vh"}})})},Tt=Dt,Ne=o(37476),St=function(j){var a,i=j.jobDetail,c=j.initSelected,s=j.onSelectChange,d=(0,A.useState)({}),t=Z()(d,2),v=t[0],u=t[1],b=i==null||(a=i.jobDataDto)===null||a===void 0||(a=a.job)===null||a===void 0?void 0:a.vertices,p=function(){var h=O()(I()().mark(function g(){return I()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,s(v);case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},g)}));return function(){return h.apply(this,arguments)}}(),f=function(g,r){u(function(m){return C()(C()({},m),{},P()({},g.id,r.map(function(x){return{taskId:i.instance.taskId,vertices:g.id,metrics:x,title:g.name,showType:"Chart",showSize:"25%"}})))})},l=b==null?void 0:b.map(function(h){return{key:h.id,label:h.name,children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Tt,{vertice:h,jobDetail:i,initSelected:c==null?void 0:c[h.id],onValueChange:f})})}});return(0,e.jsx)(Ne.Y,{width:1e3,layout:"horizontal",title:(0,n.l)("devops.jobinfo.metrics.configMetrics"),trigger:(0,e.jsx)(G.ZP,{type:"primary",children:(0,n.l)("devops.jobinfo.metrics.configMetrics")}),modalProps:{okButtonProps:{htmlType:"submit",autoFocus:!0}},onFinish:O()(I()().mark(function h(){return I()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p();case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},h)})),children:(0,e.jsx)(xe.Z,{items:l})})},yt=St,Et=o(24059),Se=o(32983),It=function(j){var a=j.jobDetail,i=j.metricsList,c=j.timeRange,s=(0,A.useState)({}),d=Z()(s,2),t=d[0],v=d[1],u=(0,Q.useModel)("Sse",function(g){return{subscribeTopic:g.subscribeTopic}}),b=u.subscribeTopic,p=(0,L.Z)(de.Pr,{defaultParams:[c,a.instance.jid],refreshDeps:[c,i],onSuccess:function(r){var m={};r.forEach(function(x){return l(m,x)})}}),f=p.loading,l=function(r,m){var x=m.content;Object.keys(x).forEach(function(k){return Object.keys(x[k]).forEach(function(R){var z="".concat(k,"-").concat(R),X={time:m.heartTime,value:x[k][R]};z in r||(r[z]=[]),r[z].push(X)})}),v(r)};(0,A.useEffect)(function(){if(c.isReal){var g="".concat(Re.Lu.METRICS,"/").concat(a.instance.jid);return b([g],function(r){l(t,r.data)})}},[c,i]);var h=function(r,m){return r&&r.length>0?r==null?void 0:r.map(function(x){var k,R="".concat(x.vertices,"-").concat(x.metrics);return(0,e.jsx)(Et.Z,{chartSize:x.showSize,chartType:x.showType,title:x.metrics,data:(k=m[R])!==null&&k!==void 0?k:[]},R)}):(0,e.jsx)(Se.Z,{className:"code-content-empty"})};return(0,e.jsx)(se.Z,{spinning:f,delay:500,children:(0,e.jsx)(De.Z,{gutter:[8,16],children:h(i!=null?i:{},t)})})},Zt=It,Ct=function(j){var a=j.jobDetail,i="".concat(a.instance.name,"-").concat(a.instance.taskId),c=(0,A.useState)({startTime:new Date().getTime()-6e4,endTime:new Date().getTime(),isReal:!0}),s=Z()(c,2),d=s[0],t=s[1],v=(0,L.Z)(de.ZP,{defaultParams:[i]}),u=(0,L.Z)(de.cy,{manual:!0,defaultParams:[i,[]]}),b=function(l){t(l)},p=function(){var f=O()(I()().mark(function l(h){var g;return I()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return g=[],Object.values(h).forEach(function(x){return g.push.apply(g,Ae()(x))}),m.next=4,u.run(i,g);case 4:return v.run(i),m.abrupt("return",!0);case 6:case"end":return m.stop()}},l)}));return function(h){return f.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(pe.Z,{style:{marginBottom:20},children:[(0,e.jsx)(mt.Z,{onTimeSelect:b}),a.instance.status==Re.jf.RUNNING?(0,e.jsx)(yt,{onSelectChange:p,jobDetail:a,initSelected:pt(v.data)}):(0,e.jsx)(e.Fragment,{})]}),(0,e.jsx)(Zt,{metricsList:v.data,jobDetail:a,timeRange:d})]})},Ot=Ct,be=o(99219),Pt=o(99384),Lt=o(24350),At=o(86548),kt=o(184),ye=o(5966),Rt=o(64317),Je=o(90672),Nt=o(18922),fe=o(96074),Jt=te.Z.Text,Mt=function(j){var a=Nt.Z.useForm(),i=Z()(a,1),c=i[0],s=j.jobDetail,d=j.refeshJob,t=function(){var v=O()(I()().mark(function u(b){var p,f;return I()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return p={id:s.clusterInstance.id,hosts:b.hosts,autoRegisters:s.clusterInstance.autoRegisters},f={id:s.instance.id,jid:b.jid},h.next=4,(0,ne.On)($.Z.CLUSTER_INSTANCE,p);case 4:return h.next=6,(0,ne.On)($.Z.JOB_INSTANCE,f);case 6:return d(!0),h.abrupt("return",!0);case 8:case"end":return h.stop()}},u)}));return function(b){return v.apply(this,arguments)}}();return(0,e.jsxs)(kt.a,{title:(0,n.l)("devops.jobinfo.remap.title"),form:c,initialValues:C()(C()({},s==null?void 0:s.clusterInstance),s==null?void 0:s.instance),trigger:(0,e.jsx)(G.ZP,{icon:(0,e.jsx)(At.Z,{})}),onFinish:t,children:[(0,e.jsxs)(fe.Z,{orientation:"left",style:{margin:"8px 0"},children:[(0,n.l)("devops.jobinfo.remap.cluster.title"),(0,e.jsxs)(Jt,{type:"danger",children:[" ",(0,n.l)("devops.jobinfo.remap.cluster.title.help")]})]}),(0,e.jsx)(ye.Z,{name:"name",label:(0,n.l)("rc.ci.name"),disabled:!0,rules:[{required:!0,message:(0,n.l)("rc.ci.namePlaceholder")}],placeholder:(0,n.l)("rc.ci.namePlaceholder")}),(0,e.jsx)(ye.Z,{name:"alias",label:(0,n.l)("rc.ci.alias"),disabled:!0,placeholder:(0,n.l)("rc.ci.aliasPlaceholder")}),(0,e.jsx)(Rt.Z,{name:"type",label:(0,n.l)("rc.ci.type"),disabled:!0,options:(0,Pt.Eg)(),rules:[{required:!0,message:(0,n.l)("rc.ci.typePlaceholder")}],placeholder:(0,n.l)("rc.ci.typePlaceholder")}),(0,e.jsx)(Je.Z,{name:"hosts",label:(0,n.l)("rc.ci.jmha"),tooltip:(0,n.l)("rc.ci.jmha.tips"),validateTrigger:["onChange"],rules:[{required:!0,validator:function(u,b){return(0,Lt.l)(u,b)}}],placeholder:(0,n.l)("rc.ci.jmhaPlaceholder")}),(0,e.jsx)(Je.Z,{name:"note",label:(0,n.l)("global.table.note"),disabled:!0,placeholder:(0,n.l)("global.table.notePlaceholder")}),(0,e.jsx)(fe.Z,{orientation:"left",style:{margin:"8px 0"},children:(0,n.l)("devops.jobinfo.remap.job.title")}),(0,e.jsx)(ye.Z,{name:"jid",label:"Job Id",placeholder:(0,n.l)("rc.ci.aliasPlaceholder")})]})},Bt=Mt,Me=o(38925),Be=te.Z.Paragraph,$t=function(j){var a=j.lastCheckpoint,i=j.instance,c=(0,L.Z)(oe.RL,{defaultParams:[i==null?void 0:i.taskId,"",(0,n.l)("devops.jobinfo.ck.recovery")],manual:!0}),s=c.data,d=c.loading,t=c.run,v=function(b,p){if(!b)return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Me.Z,{message:"Not Found ".concat(p),type:"warning"}),(0,e.jsx)("br",{})]});var f=[{key:"ckp_id",label:"ID",children:b.id},{key:"ckp_state_size",label:(0,n.l)("devops.jobinfo.ck.state_size"),children:(0,U.Dd)(b.state_size)},{key:"latest_ack_timestamp",label:(0,n.l)("devops.jobinfo.ck.latest_ack_timestamp"),children:new Date(b.latest_ack_timestamp).toLocaleString("zh-cn")},{key:"ckp_path",label:(0,n.l)("devops.jobinfo.ck.external_path"),span:4,children:(0,e.jsx)(re.Z,{maxCount:60,children:b.external_path,copyable:!1})}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(y.Z,{title:p,size:"small",bordered:!0,items:f,extra:(0,e.jsx)(G.ZP,{type:"link",onClick:function(){return t(i==null?void 0:i.taskId,b.external_path,(0,n.l)("devops.jobinfo.ck.recovery"))},children:"\u91CD\u542F\u540E\u6B64\u5904\u6062\u590D"})}),(0,e.jsx)("br",{})]})};return(0,e.jsx)(Ne.Y,{loading:d,title:(0,n.l)("devops.jobinfo.restart"),trigger:(0,e.jsx)(G.ZP,{type:"primary",children:(0,n.l)("devops.jobinfo.restart")}),submitter:!1,children:(0,e.jsxs)(se.Z,{spinning:d,children:[i!=null&&i.status&&!(0,be.N$)(i==null?void 0:i.status)?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(fe.Z,{orientation:"left",style:{margin:"8px 0"},children:(0,n.l)("devops.jobinfo.smart_restart")}),(0,e.jsx)(Be,{children:(0,e.jsx)("blockquote",{children:(0,n.l)("devops.jobinfo.smart_restart.help")})}),(0,e.jsx)(G.ZP,{type:"link",size:"small",onClick:function(){return t(i==null?void 0:i.taskId,"",(0,n.l)("devops.jobinfo.ck.recovery"))},children:(0,n.l)("devops.jobinfo.restart.auto.savepoint")})]}):(0,e.jsx)(Me.Z,{message:(0,n.l)("devops.jobinfo.restart.cannot.auto.savepoint"),type:"warning"}),(0,e.jsx)(fe.Z,{orientation:"left",style:{margin:"8px 0"},children:(0,n.l)("devops.jobinfo.restart.from.savepoint")}),(0,e.jsx)(Be,{children:(0,e.jsx)("blockquote",{children:(0,n.l)("devops.jobinfo.restart.from.savepoint.help")})}),v(a==null?void 0:a.completed,"Last Checkpoint"),v(a==null?void 0:a.savepoint,"Last Savepoint")]})})},Ft=$t,Ut=o(87740),Kt=o(89705),Gt=o(76150),zt=o(85418),Y={CANCEL_JOB:"canceljob",SAVEPOINT_CANCEL:"cancel",SAVEPOINT_TRIGGER:"trigger",SAVEPOINT_STOP:"stop",AUTO_STOP:"autostop"},Ht=function(j){var a,i,c,s,d,t=j.jobDetail,v=j.refesh,u="".concat($.Z.BASE_URL,"/api/flink/").concat(t==null||(a=t.clusterInstance)===null||a===void 0?void 0:a.jobManagerHost,"/#/job/running/").concat(t==null||(i=t.instance)===null||i===void 0?void 0:i.jid,"/overview"),b=function(f){ue.Z.confirm({title:(0,n.l)("devops.jobinfo.job.key","",{key:f}),content:(0,n.l)("devops.jobinfo.job.keyConfirm","",{key:f}),okText:(0,n.l)("button.confirm"),cancelText:(0,n.l)("button.cancel"),onOk:function(){var l=O()(I()().mark(function g(){var r,m,x,k,R;return I()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:f==Y.CANCEL_JOB?(0,oe.el)("",t==null||(r=t.instance)===null||r===void 0?void 0:r.taskId,!1):f==Y.SAVEPOINT_CANCEL?(0,oe.j3)("",t==null||(m=t.instance)===null||m===void 0?void 0:m.taskId,"cancel"):f==Y.SAVEPOINT_STOP?(0,oe.j3)("",t==null||(x=t.instance)===null||x===void 0?void 0:x.taskId,"stop"):f==Y.SAVEPOINT_TRIGGER?(0,oe.j3)("",t==null||(k=t.instance)===null||k===void 0?void 0:k.taskId,"trigger"):f==Y.AUTO_STOP&&(0,oe.el)("",t==null||(R=t.instance)===null||R===void 0?void 0:R.taskId),Gt.ZP.success((0,n.l)("devops.jobinfo.job.key.success","",{key:f}));case 2:case"end":return X.stop()}},g)}));function h(){return l.apply(this,arguments)}return h}()})};return(0,e.jsxs)(pe.Z,{children:[(0,e.jsx)(Bt,{jobDetail:t,refeshJob:v}),(0,e.jsx)(G.ZP,{icon:(0,e.jsx)(Ut.Z,{}),onClick:function(){return v(!0)}}),(0,e.jsx)(G.ZP,{href:u,target:"_blank",children:"FlinkWebUI"},"flinkwebui"),(0,e.jsx)(Ft,{lastCheckpoint:t==null||(c=t.jobDataDto)===null||c===void 0||(c=c.checkpoints)===null||c===void 0?void 0:c.latest,instance:t==null?void 0:t.instance}),(0,be.N$)(t==null||(s=t.instance)===null||s===void 0?void 0:s.status)?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(G.ZP,{type:"primary",onClick:function(){return b(Y.AUTO_STOP)},danger:!0,children:(t==null||(d=t.instance)===null||d===void 0?void 0:d.step)==5?(0,n.l)("devops.jobinfo.offline"):(0,n.l)("devops.jobinfo.smart_stop")},"autostop"),(0,e.jsx)(zt.Z,{trigger:["click"],menu:{onClick:function(f){return b(f.key)},items:[{key:Y.SAVEPOINT_TRIGGER,label:(0,n.l)("devops.jobinfo.savepoint.trigger")},{key:Y.SAVEPOINT_STOP,label:(0,n.l)("devops.jobinfo.savepoint.stop")},{key:Y.SAVEPOINT_CANCEL,label:(0,n.l)("devops.jobinfo.savepoint.cancel")},{key:Y.CANCEL_JOB,label:(0,n.l)("devops.jobinfo.savepoint.canceljob")}]},children:(0,e.jsx)(G.ZP,{style:{padding:"0 8px"},children:(0,e.jsx)(Kt.Z,{})},"4")},"dropdown")]})]})},Vt=Ht,Wt=o(82866),Yt=o(88028),wt=te.Z.Link,Qt=function(j){var a,i=j.jobDetail,c=[{title:(0,n.l)("devops.baseinfo.name"),dataIndex:"name",ellipsis:!0,width:"20%",render:function(d,t){return(0,e.jsx)(wt,{children:t.name})}},{title:(0,n.l)("devops.baseinfo.status"),dataIndex:"status",sorter:!0,width:"8%",render:function(d,t){return(0,e.jsx)(B.Z,{status:t.status})}},{title:(0,n.l)("devops.baseinfo.readbytes"),width:"7%",render:function(d,t){return(0,U.Dd)(t.metrics["read-bytes"])}},{title:(0,n.l)("devops.baseinfo.readrecords"),width:"7%",render:function(d,t){return(0,U.Df)(t.metrics["read-records"])}},{title:(0,n.l)("devops.baseinfo.writebytes"),width:"7%",render:function(d,t){return(0,U.Dd)(t.metrics["write-bytes"])}},{title:(0,n.l)("devops.baseinfo.writerecords"),width:"7%",render:function(d,t){return(0,U.Df)(t.metrics["write-records"])}},{title:(0,n.l)("devops.baseinfo.parallelism"),sorter:!0,width:"7%",dataIndex:"parallelism"},{title:(0,n.l)("global.table.startTime"),render:function(d,t){return t.startTime===-1||t["start-time"]===-1?"-":(0,U.WG)(t["start-time"])||(0,U.WG)(t.startTime)}},{title:(0,n.l)("global.table.endTime"),render:function(d,t){return t.endTime===-1||t["end-time"]===-1?"-":(0,U.WG)(t["end-time"])||(0,U.WG)(t.endTime)}},{title:(0,n.l)("global.table.useTime"),render:function(d,t){return(0,U.FV)(t.duration)}}];return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(V.Z,{children:(0,e.jsx)(Yt.Z,{defaultSize:"small",columns:c,style:{width:"100%",height:"30vh"},dataSource:i==null||(a=i.jobDataDto)===null||a===void 0||(a=a.job)===null||a===void 0?void 0:a.vertices,rowKey:"name",pagination:{defaultPageSize:10,showSizeChanger:!0,hideOnSinglePage:!0},toolBarRender:!1,search:!1,size:"small"})})})},Xt=Qt,$e=te.Z.Text,_t=function(j){var a,i,c,s,d,t,v,u,b,p,f,l,h,g,r=j.jobDetail,m=function(k){switch(k){case"NONE":return(0,n.l)("global.savepoint.strategy.disabled");case"LATEST":return(0,n.l)("global.savepoint.strategy.latest");case"EARLIEST":return(0,n.l)("global.savepoint.strategy.earliest");case"CUSTOM":return(0,n.l)("global.savepoint.strategy.custom");default:return(0,n.l)("global.savepoint.strategy.disabled")}};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(V.Z,{children:(0,e.jsxs)(y.Z,{bordered:!0,size:"small",column:5,children:[(0,e.jsx)(y.Z.Item,{label:(0,n.l)("global.table.status"),children:(0,e.jsx)(B.Z,{status:r==null||(a=r.instance)===null||a===void 0?void 0:a.status})}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("devops.jobinfo.config.submitType"),children:(0,e.jsxs)(T.Z,{color:"pink",children:[(0,e.jsx)(me.Z,{})," ",r==null||(i=r.history)===null||i===void 0?void 0:i.type]})}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("devops.jobinfo.config.RestartStrategy"),children:(0,e.jsx)(T.Z,{color:"blue",title:"Restart Strategy",children:r==null||(c=r.jobDataDto)===null||c===void 0?void 0:c.config["execution-config"]["restart-strategy"]})}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("devops.jobinfo.config.ClusterInstanceName"),children:(0,e.jsx)(Q.Link,{to:"/registration/cluster/instance",children:r==null||(s=r.clusterInstance)===null||s===void 0?void 0:s.alias})}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("devops.jobinfo.config.JobId"),children:(0,e.jsx)($e,{copyable:!0,children:r==null||(d=r.instance)===null||d===void 0?void 0:d.jid})}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("devops.jobinfo.config.taskId"),children:(0,e.jsx)($e,{copyable:!0,children:r==null||(t=r.instance)===null||t===void 0?void 0:t.taskId})}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("devops.jobinfo.config.useSqlFragment"),children:r!=null&&(v=r.history)!==null&&v!==void 0&&(v=v.configJson)!==null&&v!==void 0&&v.fragment?(0,n.l)("button.enable"):(0,n.l)("button.disable")}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("devops.jobinfo.config.execmode"),children:r!=null&&(u=r.history)!==null&&u!==void 0&&(u=u.configJson)!==null&&u!==void 0&&u.batchModel?(0,n.l)("global.table.execmode.batch"):(0,n.l)("global.table.execmode.streaming")}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("global.table.createTime"),children:r==null||(b=r.instance)===null||b===void 0||(b=b.createTime)===null||b===void 0?void 0:b.toString()}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("devops.jobinfo.config.JobParallelism"),children:r==null||(p=r.jobDataDto)===null||p===void 0?void 0:p.config["execution-config"]["job-parallelism"]}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("global.table.useTime"),children:(0,U.FV)(r==null||(f=r.instance)===null||f===void 0?void 0:f.duration)}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("devops.jobinfo.config.startFromSavePoint"),children:m(r==null||(l=r.history)===null||l===void 0||(l=l.configJson)===null||l===void 0?void 0:l.savePointStrategy)}),(0,e.jsx)(y.Z.Item,{label:(0,n.l)("devops.jobinfo.config.savePointPath"),span:2,children:(h=r==null||(g=r.history)===null||g===void 0||(g=g.configJson)===null||g===void 0?void 0:g.configJson["state.savepoints.dir"])!==null&&h!==void 0?h:"-"})]})}),(0,e.jsx)("br",{})]})},qt=_t,en=function(j){var a,i,c,s=j.jobDetail,d=s==null||(a=s.jobDataDto)===null||a===void 0?void 0:a.job,t=(0,A.useState)(!1),v=Z()(t,2),u=v[0],b=v[1];return(0,e.jsxs)(e.Fragment,{children:[(0,be.$N)(s==null||(i=s.instance)===null||i===void 0?void 0:i.status)&&!u?(0,e.jsx)(Le.ZP,{status:"warning",title:(0,n.l)("devops.jobinfo.unable.obtain.status"),extra:(0,e.jsx)(G.ZP,{type:"primary",onClick:function(){b(!0)},children:(0,n.l)("devops.jobinfo.recently.job.status")},"console")}):void 0,u||!(0,be.$N)(s==null||(c=s.instance)===null||c===void 0?void 0:c.status)?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qt,{jobDetail:s}),(0,e.jsx)(V.Z,{style:{height:"40vh"},children:d?(0,e.jsx)(Wt.Z,{job:d,checkPoints:s.jobDataDto.checkpoints}):(0,e.jsx)(Se.Z,{image:Se.Z.PRESENTED_IMAGE_SIMPLE})}),(0,e.jsx)(Xt,{jobDetail:s})]}):void 0]})},tn=en,nn=o(46155),on=o(57857),an=o(46482),Fe=o(18127),rn=function(j){var a=j.jobDetail,i={id:-1,type:a.history.type,statement:a.history.statement,createTime:a.history.startTime,versionId:"Current",isLatest:!0},c=(0,A.useRef)(null),s=(0,A.useState)(i),d=Z()(s,2),t=d[0],v=d[1],u=(0,Q.useRequest)({url:$.Z.GET_JOB_VERSION,params:{taskId:a.history.taskId}},{onSuccess:function(l,h){l.splice(0,0,i)}}),b=function(){var f=O()(I()().mark(function l(h){return I()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,ne.m0)($.Z.GET_JOB_VERSION,h.id);case 2:u.run();case 3:case"end":return r.stop()}},l)}));return function(h){return f.apply(this,arguments)}}(),p=function(){var l;return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(an.o,{split:"vertical",defaultSizes:[100,500],minSize:150,className:"split-pane",children:[(0,e.jsx)(Fe.Pane,{className:"split-pane",forwardRef:c,minSize:100,size:100,split:"horizontal",children:(0,e.jsx)(nn.Z,{loading:u.loading,data:u.data,onDeleteListen:b,onSelectListen:function(g){return v(g)},header:(0,n.l)("devops.jobinfo.version.versionList")})}),(0,e.jsx)(Fe.Pane,{className:"split-pane",forwardRef:c,minSize:100,size:100,split:"horizontal",children:(0,e.jsx)(V.Z,{ghost:!0,hoverable:!0,bordered:!0,size:"small",bodyStyle:{height:parent.innerHeight},title:"V-"+(t==null?void 0:t.versionId),extra:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(T.Z,{color:"blue",children:t==null?void 0:t.type},"v-type"),(0,e.jsx)(T.Z,{color:"success",children:t==null?void 0:t.dialect},"v-dialect")]}),children:(0,e.jsx)(W.Z,{showFloatButton:!0,code:(l=t==null?void 0:t.statement)!==null&&l!==void 0?l:"",height:parent.innerHeight-250,language:(0,on.k)(t==null?void 0:t.dialect)})})})]})})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(V.Z,{size:"small",bodyStyle:{height:"calc(100vh - 180px)",overflow:"auto"},children:p()})})},ln=rn,sn=o(10581),dn=o(1832),cn=o(40717),un=o(11774),N={JOB_BASE_INFO:"job_base_info",JOB_LOGS:"job_logs",JOB_VERSION:"job_version",JOB_CHECKPOINTS:"job_checkpoints",JOB_ALERT:"job_alert",JOB_METRICS:"job_monitor",JOB_LINEAGE:"job_lineage"},vn=function(j){var a,i,c,s,d,t,v=(0,Q.useLocation)(),u=v.search.split("=")[1];u||sn.m.push("/devops/");var b=(0,L.Z)(de.o1,{defaultParams:[u,!1],pollingInterval:3e3}),p=b.data,f=b.run,l=p,h=(0,A.useState)(N.JOB_BASE_INFO),g=Z()(h,2),r=g[0],m=g[1],x=P()(P()(P()(P()(P()(P()(P()({},N.JOB_BASE_INFO,(0,e.jsx)(tn,{jobDetail:l})),N.JOB_LOGS,(0,e.jsx)(gt,{jobDetail:l})),N.JOB_VERSION,(0,e.jsx)(ln,{jobDetail:l})),N.JOB_CHECKPOINTS,(0,e.jsx)(ot,{jobDetail:l})),N.JOB_METRICS,(0,e.jsx)(Ot,{jobDetail:l})),N.JOB_LINEAGE,(0,e.jsx)(rt,{jobDetail:l})),N.JOB_ALERT,(0,e.jsx)(Ve,{jobDetail:l})),k=[{tab:(0,n.l)("devops.jobinfo.config.JobInfo"),key:N.JOB_BASE_INFO},{tab:(0,n.l)("devops.jobinfo.config.JobLogs"),key:N.JOB_LOGS},{tab:(0,n.l)("devops.jobinfo.config.JobVersion"),key:N.JOB_VERSION},{tab:(0,n.l)("devops.jobinfo.config.JobCheckpoints"),key:N.JOB_CHECKPOINTS},{tab:(0,n.l)("devops.jobinfo.config.JobMonitor"),key:N.JOB_METRICS},{tab:(0,n.l)("devops.jobinfo.config.JobLineage"),key:N.JOB_LINEAGE},{tab:(0,n.l)("devops.jobinfo.config.JobAlert"),key:N.JOB_ALERT}];return console.log(!!p),(0,e.jsx)(un._z,{loading:!p,title:l==null||(a=l.instance)===null||a===void 0?void 0:a.name,subTitle:(0,e.jsx)(E.Z,{status:l==null||(i=l.instance)===null||i===void 0?void 0:i.step}),ghost:!1,extra:(0,e.jsx)(Vt,{jobDetail:l,refesh:function(z){return f(u,z)}}),onBack:function(){return window.history.back()},breadcrumb:{},tabList:k,onTabChange:function(z){return m(z)},tags:[(0,e.jsx)(B.Z,{status:l==null||(c=l.instance)===null||c===void 0?void 0:c.status}),(0,e.jsxs)(T.Z,{color:"blue",children:[(0,e.jsx)(dn.Z,{})," ",l==null||(s=l.instance)===null||s===void 0?void 0:s.jid]},"tg1"),(0,e.jsxs)(T.Z,{color:"blue",children:[(0,e.jsx)(me.Z,{})," ",l==null||(d=l.history)===null||d===void 0?void 0:d.type]},"tg2"),(0,e.jsxs)(T.Z,{color:"green",children:[(0,e.jsx)(cn.Z,{})," ",l==null||(t=l.clusterInstance)===null||t===void 0?void 0:t.alias]},"tg3")],children:x[r]})},hn=vn},24350:function(le,K,o){o.d(K,{l:function(){return ae},n:function(){return I}});var D=o(79935),P=o(58023),F=o(41913),Z=o(17057),E=o(85893),B=Z.Z.Text,L=Z.Z.Paragraph,w=Z.Z.Link,ae=function(O){var ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",C=[];if(ie.trim().length===0)return Promise.reject(new Error((0,F.l)("rc.ci.jmhaPlaceholder")));C=ie.split(",");for(var ee=0;ee<C.length;ee++){if(C[ee].includes("/"))return Promise.reject(new Error((0,F.l)("rc.ci.jmha.validate.slash")));if(parseInt(C[ee].split(":")[1])>=65535)return Promise.reject(new Error((0,F.l)("rc.ci.jmha.validate.port")))}return Promise.resolve()},I=function(O){return O.status&&(O.type===D.Gd.YARN_SESSION||O.type===D.Gd.STANDALONE||O.type===D.Gd.YARN_APPLICATION||O.type===D.Gd.YARN_PER_JOB)?(0,E.jsx)(w,{href:"".concat(P.Z.BASE_URL,"/api/flink/").concat(O.jobManagerHost,"/#/overview"),target:"_blank",children:O.jobManagerHost},"".concat(O.id,"_webui")):(0,E.jsx)(w,{children:O.hosts})}},99384:function(le,K,o){o.d(K,{Eg:function(){return F},Lp:function(){return Z},Wm:function(){return D},yY:function(){return P}});var D=function(E){return E.STANDALONE="standalone",E.YARN="yarn-application",E.YARN_SESSION="yarn-session",E.KUBERNETES_SESSION="kubernetes-session",E.KUBERNETES_APPLICATION="kubernetes-application",E.KUBERNETES_OPERATOR="kubernetes-application-operator",E.YARN_APPLICATION="yarn-application",E.LOCAL="local",E}({}),P=[{value:D.STANDALONE,label:"Standalone",key:D.STANDALONE},{value:D.YARN_SESSION,label:"Yarn Session",key:D.YARN_SESSION},{value:D.KUBERNETES_SESSION,label:"Kubernetes Session",key:D.KUBERNETES_SESSION},{value:D.KUBERNETES_APPLICATION,label:"Kubernetes Application",key:D.KUBERNETES_APPLICATION},{value:D.KUBERNETES_OPERATOR,label:"Kubernetes Operator",key:D.KUBERNETES_OPERATOR},{value:D.YARN_APPLICATION,label:"Yarn Application",key:D.YARN_APPLICATION},{value:D.LOCAL,label:"Local",key:D.LOCAL}],F=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return P.filter(function(L){return!B.includes(L.value)})},Z=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return P.filter(function(L){return B.includes(L.value)})}}}]);
