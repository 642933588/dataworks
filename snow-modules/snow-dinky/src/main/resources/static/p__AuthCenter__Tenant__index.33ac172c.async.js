"use strict";(self.webpackChunkdinky_web=self.webpackChunkdinky_web||[]).push([[1497],{5966:function(ie,$,e){var k=e(97685),_=e(1413),P=e(45987),H=e(21770),s=e(18922),z=e(55241),t=e(97435),te=e(67294),v=e(31649),S=e(85893),K=["fieldProps","proFieldProps"],q=["fieldProps","proFieldProps"],M="text",ae=function(p){var o=p.fieldProps,L=p.proFieldProps,n=(0,P.Z)(p,K);return(0,S.jsx)(v.Z,(0,_.Z)({valueType:M,fieldProps:o,filedConfig:{valueType:M},proFieldProps:L},n))},re=function(p){var o=(0,H.Z)(p.open||!1,{value:p.open,onChange:p.onOpenChange}),L=(0,k.Z)(o,2),n=L[0],B=L[1];return(0,S.jsx)(s.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(G){var D,N=G.getFieldValue(p.name||[]);return(0,S.jsx)(z.Z,(0,_.Z)((0,_.Z)({getPopupContainer:function(E){return E&&E.parentNode?E.parentNode:E},onOpenChange:B,content:(0,S.jsxs)("div",{style:{padding:"4px 0"},children:[(D=p.statusRender)===null||D===void 0?void 0:D.call(p,N),p.strengthText?(0,S.jsx)("div",{style:{marginTop:10},children:(0,S.jsx)("span",{children:p.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},p.popoverProps),{},{open:n,children:p.children}))}})},Z=function(p){var o=p.fieldProps,L=p.proFieldProps,n=(0,P.Z)(p,q),B=(0,te.useState)(!1),Y=(0,k.Z)(B,2),G=Y[0],D=Y[1];return o!=null&&o.statusRender&&n.name?(0,S.jsx)(re,{name:n.name,statusRender:o==null?void 0:o.statusRender,popoverProps:o==null?void 0:o.popoverProps,strengthText:o==null?void 0:o.strengthText,open:G,onOpenChange:D,children:(0,S.jsx)("div",{children:(0,S.jsx)(v.Z,(0,_.Z)({valueType:"password",fieldProps:(0,_.Z)((0,_.Z)({},(0,t.default)(o,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(m){var E;o==null||(E=o.onBlur)===null||E===void 0||E.call(o,m),D(!1)},onClick:function(m){var E;o==null||(E=o.onClick)===null||E===void 0||E.call(o,m),D(!0)}}),proFieldProps:L,filedConfig:{valueType:M}},n))})}):(0,S.jsx)(v.Z,(0,_.Z)({valueType:"password",fieldProps:o,proFieldProps:L,filedConfig:{valueType:M}},n))},V=ae;V.Password=Z,V.displayName="ProFormComponent",$.Z=V},90672:function(ie,$,e){var k=e(1413),_=e(45987),P=e(67294),H=e(31649),s=e(85893),z=["fieldProps","proFieldProps"],t=function(v,S){var K=v.fieldProps,q=v.proFieldProps,M=(0,_.Z)(v,z);return(0,s.jsx)(H.Z,(0,k.Z)({ref:S,valueType:"textarea",fieldProps:K,proFieldProps:q},M))};$.Z=P.forwardRef(t)},51605:function(ie,$,e){var k=e(97857),_=e.n(k),P=e(13769),H=e.n(P),s=e(88028),z=e(40784),t=e(96486),te=e.n(t),v=e(85893),S=["leftColumns","rightColumns"],K=function(M){var ae=M.leftColumns,re=M.rightColumns,Z=H()(M,S);return(0,v.jsx)(z.Z,_()(_()({showSelectAll:!1,showSearch:!0},Z),{},{children:function(l){var p=l.direction,o=l.filteredItems,L=l.onItemSelectAll,n=l.onItemSelect,B=l.selectedKeys,Y=l.disabled,G=p==="left"?ae:re,D={getCheckboxProps:function(m){return{disabled:Y||m.isDelete||(m.hasOwnProperty("enabled")?!m.enabled:!1)}},onSelectAll:function(m,E){var le=E.filter(function(Q){return!Q.isDelete||!Q.enabled}).map(function(Q){var W=Q.id;return W}),ue=m?(0,t.difference)(le,B):(0,t.difference)(B,le);L(ue,m)},onSelect:function(m,E){n(m.id,E)},selectedRowKeys:B};return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(s.Z,{size:"small",ghost:!0,toolBarRender:void 0,rowSelection:D,rowKey:function(m){return m.id},columns:G,search:!1,options:!1,tableAlertRender:!1,dataSource:o,pagination:{pageSize:10,showSizeChanger:!1,hideOnSinglePage:!0},style:{height:"50vh",overflowY:"auto",pointerEvents:Y?"none":void 0},onRow:function(m){return{onClick:function(){!m.hasOwnProperty("isDelete")||m.isDelete||m.hasOwnProperty("enabled")&&!m.enabled||n(m.id,!B.includes(m.id))}}}})})}}))};$.Z=K},29397:function(ie,$,e){e.r($),e.d($,{default:function(){return _e}});var k=e(68166),_=e(11774),P=e(67294),H=e(15009),s=e.n(H),z=e(97857),t=e.n(z),te=e(99289),v=e.n(te),S=e(5574),K=e.n(S),q=e(3527),M=e(60982),ae=e(28712),re=e(63167),Z=e(49881),V=e(79935),l=e(41913),p=e(5966),o=e(90672),L=e(97269),n=e(85893),B=function(h){var b=h.values,d=h.form,c=function(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z,{name:"tenantCode",label:(0,l.l)("tenant.TenantCode"),placeholder:(0,l.l)("tenant.EnterTenantCode"),rules:[{required:!0,message:(0,l.l)("tenant.EnterTenantCode")}]}),(0,n.jsx)(o.Z,{name:"note",allowClear:!0,label:(0,l.l)("global.table.note"),placeholder:(0,l.l)("tenant.EnterTenantNote"),rules:[{required:!0,message:(0,l.l)("tenant.EnterTenantNote")}]})]})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(L.A,t()(t()({},V.pA),{},{form:d,initialValues:b,submitter:!1,layout:"horizontal",children:c()}))})},Y=B,G=e(18922),D=e(85576),N=function(h){var b=G.Z.useForm(),d=K()(b,1),c=d[0],U=P.useMemo(function(){return{resetForm:function(){return c.resetFields()}}},[c]),I=h.onSubmit,O=h.onCancel,R=h.modalVisible,y=h.values;(0,P.useEffect)(function(){c.setFieldsValue(y)},[R,y,c]);var x=function(){O(),U.resetForm()},g=function(){var i=v()(s()().mark(function C(){var ne;return s()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,c.validateFields();case 2:ne=J.sent,I(t()(t()({},y),ne)),x();case 5:case"end":return J.stop()}},C)}));return function(){return i.apply(this,arguments)}}();return(0,n.jsx)(D.Z,t()(t()({},V.SU),{},{title:y.id?(0,l.l)("tenant.update"):(0,l.l)("tenant.create"),open:R,onOk:function(){return g()},okButtonProps:{htmlType:"submit",autoFocus:!0},onCancel:function(){return x()},children:(0,n.jsx)(Y,{values:y,form:c})}))},m=N,E=e(19632),le=e.n(E),ue=e(51605),Q=e(25538),W=e(58023),de=e(14737),ce=function(h){var b=h.tenant,d=h.onChange,c=(0,P.useState)(de.RL),U=K()(c,2),I=U[0],O=U[1],R=function(i,C){var ne=[].concat(le()(i),le()(C));O(function(oe){return t()(t()({},oe),{},{selectedKeys:ne})})};(0,P.useEffect)(function(){(0,Q.Yu)(W.Z.GET_USER_LIST_BY_TENANTID,{id:b.id}).then(function(g){O(function(i){return t()(t()({},i),{},{userList:g.data.users,targetKeys:g.data.userIds})}),d(g.data.userIds)})},[]);var y=[{title:(0,l.l)("user.username"),dataIndex:"username"},{title:(0,l.l)("user.nickname"),dataIndex:"nickname"},{title:(0,l.l)("user.jobnumber"),dataIndex:"worknum"}],x=function(i){O(function(C){return t()(t()({},C),{},{targetKeys:i})}),d(i)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(ue.Z,{dataSource:I.userList,targetKeys:I.targetKeys,selectedKeys:I.selectedKeys,rowKey:function(i){return i.id},onChange:x,onSelectChange:R,filterOption:function(i,C){return!C.username||!C.nickname||!C.worknum?!1:C.username.toLowerCase().indexOf(i.toLowerCase())!==-1||C.nickname.toLowerCase().indexOf(i.toLowerCase())!==-1||C.worknum.toLowerCase().indexOf(i.toLowerCase())!==-1},leftColumns:y,rightColumns:y})})},fe=ce,ve=function(h){var b=h.tenant,d=h.modalVisible,c=h.onCancel,U=h.onSubmit,I=h.onChange,O=(0,P.useState)([]),R=K()(O,2),y=R[0],x=R[1],g=function(C){I(C),x(C)};return(0,n.jsx)(D.Z,{title:(0,l.l)("tenant.AssignUser"),open:d,destroyOnClose:!0,maskClosable:!1,width:"75%",onCancel:function(){return c()},okButtonProps:{htmlType:"submit",autoFocus:!0},onOk:function(){return U(y)},children:(0,n.jsx)(fe,{tenant:b,onChange:function(C){return g(C)}})})},me=ve,w=e(81029),he=e(88028),Te=e(14726),pe=e(85265),Ce=function(h){var b=(0,P.useRef)(),d=h.tenant,c=h.loading,U=h.userList,I=h.open,O=h.onClose,R=h.onSubmit;(0,P.useEffect)(function(){var x,g;(x=b.current)===null||x===void 0||(g=x.reload)===null||g===void 0||g.call(x)},[U,d]);var y=[{title:(0,l.l)("user.username"),dataIndex:"username",key:"username"},{title:(0,l.l)("user.nickname"),dataIndex:"nickname",key:"nickname"},{title:(0,l.l)("user.superAdminFlag"),dataIndex:"superAdminFlag",valueEnum:w.ef,hideInSearch:!0,filters:w.oF,filterMultiple:!1},{title:(0,l.l)("user.tenantAdminFlag"),dataIndex:"tenantAdminFlag",valueEnum:w.ef,hideInSearch:!0,filters:w.oF,filterMultiple:!1},{title:(0,l.l)("global.table.operate"),valueType:"option",width:"10%",fixed:"right",render:function(g,i){return[(0,n.jsx)(Z.FY,{path:w.k5.AUTH_TENANT_SET_USER_TO_TENANT_ADMIN,children:(0,n.jsx)(Te.ZP,{type:"link",title:i.tenantAdminFlag?(0,l.l)("tenant.cancel.admin"):(0,l.l)("tenant.set.admin"),onClick:function(){return R(i)},children:i.tenantAdminFlag?(0,l.l)("tenant.cancel.admin"):(0,l.l)("tenant.set.admin")},"".concat(i.id,"_set_tenant_m"))},"".concat(i.id,"_set_tenant_m_auth"))]}}];return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(pe.Z,{title:"".concat(d.tenantCode," - ").concat((0,l.l)("tenant.user.list")),width:"50%",open:I,maskClosable:!1,onClose:O,children:(0,n.jsx)(he.Z,{search:!1,pagination:!1,options:!1,rowKey:"id",actionRef:b,loading:c,dataSource:U,columns:y})})})},ge=Ce,se=e(21953),Ee=e(16894),Pe=function(){var h=(0,P.useState)(de.Do),b=K()(h,2),d=b[0],c=b[1],U=(0,P.useRef)(),I=function(){var u=v()(s()().mark(function a(r){return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:(0,se.Ri)(W.Z.TENANT_USERS,{id:r}).then(function(j){return c(function(A){return t()(t()({},A),{},{tenantUserList:j})})});case 1:case"end":return f.stop()}},a)}));return function(r){return u.apply(this,arguments)}}(),O=function(){var u=v()(s()().mark(function a(r){var T,f;return s()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return c(function(F){return t()(t()({},F),{},{loading:!0})}),A.next=3,r();case 3:c(function(F){return t()(t()({},F),{},{loading:!1})}),(T=U.current)===null||T===void 0||(f=T.reload)===null||f===void 0||f.call(T);case 5:case"end":return A.stop()}},a)}));return function(r){return u.apply(this,arguments)}}(),R=function(){var u=v()(s()().mark(function a(r){return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,O(v()(s()().mark(function j(){return s()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.abrupt("return",(0,se.On)(W.Z.TENANT,r,function(){},function(){return c(function(X){return t()(t()({},X),{},{addedOpen:!1})})}));case 1:case"end":return F.stop()}},j)})));case 2:case"end":return f.stop()}},a)}));return function(r){return u.apply(this,arguments)}}(),y=function(){var u=v()(s()().mark(function a(r){return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,O(v()(s()().mark(function j(){return s()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.abrupt("return",(0,se.m0)(W.Z.TENANT_DELETE,r));case 1:case"end":return F.stop()}},j)})));case 2:case"end":return f.stop()}},a)}));return function(r){return u.apply(this,arguments)}}(),x=function(){var u=v()(s()().mark(function a(){return s()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,O(v()(s()().mark(function f(){return s()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.abrupt("return",(0,se.On)(W.Z.ASSIGN_USER_TO_TENANT,{tenantId:d.value.id,userIds:d.tenantUserIds}));case 1:case"end":return A.stop()}},f)})));case 2:c(function(f){return t()(t()({},f),{},{assignUserOpen:!1})});case 3:case"end":return T.stop()}},a)}));return function(){return u.apply(this,arguments)}}(),g=function(){c(function(a){return t()(t()({},a),{},{addedOpen:!1,editOpen:!1,assignUserOpen:!1})})},i=function(a){c(function(r){return t()(t()({},r),{},{tenantUserIds:a})})},C=function(a){c(function(r){return t()(t()({},r),{},{editOpen:!0,value:a})})},ne=function(a){c(function(r){return t()(t()({},r),{},{assignUserOpen:!0,value:a})})},oe=function(){var u=v()(s()().mark(function a(r){return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,I(r.id);case 2:c(function(j){return t()(t()({},j),{},{viewUsersOpen:!0,value:r})});case 3:case"end":return f.stop()}},a)}));return function(r){return u.apply(this,arguments)}}(),J=function(){var u=v()(s()().mark(function a(r){var T;return s()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return T=!1,r.tenantAdminFlag&&(T=!0),j.next=4,O(v()(s()().mark(function A(){return s()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,(0,se.Q$)(W.Z.USER_SET_TENANT_ADMIN,{userId:r.id,tenantId:d.value.id,tenantAdminFlag:T});case 2:return X.next=4,I(d.value.id);case 4:case"end":return X.stop()}},A)})));case 4:case"end":return j.stop()}},a)}));return function(r){return u.apply(this,arguments)}}(),Oe=[{title:(0,l.l)("tenant.TenantCode"),dataIndex:"tenantCode",render:function(a,r){return(0,Z.ux)(w.k5.AUTH_TENANT_VIEW_USER)?(0,n.jsxs)("a",{onClick:function(){return oe(r)},children:[" ",a," "]}):(0,n.jsxs)("span",{children:[" ",a," "]})}},{title:(0,l.l)("global.table.note"),dataIndex:"note",ellipsis:!0},{title:(0,l.l)("global.table.createTime"),dataIndex:"createTime",valueType:"dateTime",hideInSearch:!0},{title:(0,l.l)("global.table.updateTime"),dataIndex:"updateTime",hideInSearch:!0,valueType:"dateTime"},{title:(0,l.l)("global.table.operate"),valueType:"option",width:"10%",fixed:"right",render:function(a,r){return[(0,n.jsx)(Z.FY,{path:w.k5.AUTH_TENANT_EDIT,children:(0,n.jsx)(ae.m,{onClick:function(){return C(r)}},"".concat(r.id,"_edit"))},"".concat(r.id,"_edit_auth")),(0,n.jsx)(Z.FY,{path:w.k5.AUTH_TENANT_ASSIGN_USER,children:(0,n.jsx)(q.F,{onClick:function(){return ne(r)},title:(0,l.l)("tenant.AssignUser")},"".concat(r.id,"_ass"))},"".concat(r.id,"_ass_auth")),(0,n.jsx)(Z.FY,{path:w.k5.AUTH_TENANT_DELETE,children:(0,n.jsx)(n.Fragment,{children:r.id!==1&&(0,n.jsx)(re.i,{onClick:function(){return y(r.id)},description:(0,l.l)("tenant.deleteConfirm")},"".concat(r.id,"_delete"))})},"".concat(r.id,"_delete_auth"))]}}];return(0,n.jsxs)(n.Fragment,{children:[(0,P.createElement)(Ee.ZP,t()(t()({},V.xc),{},{key:"tenantTable",loading:d.loading,headerTitle:(0,l.l)("tenant.TenantManager"),actionRef:U,toolBarRender:function(){return[(0,n.jsx)(Z.FY,{path:w.k5.AUTH_TENANT_ADD,children:(0,n.jsx)(M.q,{onClick:function(){return c(function(r){return t()(t()({},r),{},{addedOpen:!0})})}},"tenantTable")},"CreateTenant_auth")]},request:function(a,r,T){return(0,Q.et)(W.Z.TENANT,t()(t()({},a),{},{sorter:r,filter:T}))},columns:Oe})),(0,n.jsx)(m,{onSubmit:function(a){return R(a)},onCancel:function(){return g()},modalVisible:d.addedOpen,values:{}},"tenantFormAdd"),(0,n.jsx)(m,{onSubmit:function(a){return R(a)},onCancel:function(){return g()},modalVisible:d.editOpen,values:d.value},"tenantFormUpdate"),(0,n.jsx)(me,{tenant:d.value,modalVisible:d.assignUserOpen,onChange:function(a){return i(a)},onCancel:function(){return g()},onSubmit:function(){return x()}}),d.value&&Object.keys(d.value).length>0&&(0,n.jsx)(ge,{tenant:d.value,open:d.viewUsersOpen,userList:d.tenantUserList,loading:d.loading,onClose:function(){return c(function(a){return t()(t()({},a),{},{viewUsersOpen:!1})})},onSubmit:J})]})},Se=Pe,Ae=function(){return(0,n.jsx)(k.Z,{children:(0,n.jsx)(_._z,{title:!1,children:(0,n.jsx)(Se,{})})})},_e=Ae}}]);
